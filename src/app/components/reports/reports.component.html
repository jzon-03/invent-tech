<div class="reports-container">
  <!-- Header Section -->
  <div class="header">
    <div class="header-title">
      <h1>Reports & Analytics</h1>
      <p>Comprehensive insights and data analysis for your inventory</p>
    </div>
    <div class="header-actions">
      <button mat-raised-button color="primary" (click)="generateCustomReport()">
        <mat-icon>assessment</mat-icon>
        Custom Report
      </button>
      <button mat-stroked-button (click)="scheduleReport()">
        <mat-icon>schedule</mat-icon>
        Schedule
      </button>
      <button mat-button [matMenuTriggerFor]="exportMenu">
        <mat-icon>file_download</mat-icon>
        Export
      </button>
      <mat-menu #exportMenu="matMenu">
        <button mat-menu-item (click)="exportReport('pdf')">
          <mat-icon>picture_as_pdf</mat-icon>
          Export as PDF
        </button>
        <button mat-menu-item (click)="exportReport('excel')">
          <mat-icon>table_view</mat-icon>
          Export as Excel
        </button>
        <button mat-menu-item (click)="exportReport('csv')">
          <mat-icon>description</mat-icon>
          Export as CSV
        </button>
      </mat-menu>
    </div>
  </div>

  <!-- Date Range Filter -->
  <mat-card class="date-filter">
    <mat-card-content>
      <div class="filter-row">
        <h3>Report Period</h3>
        <mat-button-toggle-group [(ngModel)]="selectedPeriod" (change)="onPeriodChange()" class="period-toggle">
          <mat-button-toggle value="today">Today</mat-button-toggle>
          <mat-button-toggle value="week">This Week</mat-button-toggle>
          <mat-button-toggle value="month">This Month</mat-button-toggle>
          <mat-button-toggle value="quarter">Quarter</mat-button-toggle>
          <mat-button-toggle value="year">Year</mat-button-toggle>
          <mat-button-toggle value="custom">Custom</mat-button-toggle>
        </mat-button-toggle-group>
        
        <div *ngIf="selectedPeriod === 'custom'" class="custom-date-range">
          <mat-form-field appearance="outline">
            <mat-label>From Date</mat-label>
            <input matInput [matDatepicker]="fromPicker" [(ngModel)]="fromDate" (dateChange)="onDateChange()">
            <mat-datepicker-toggle matSuffix [for]="fromPicker"></mat-datepicker-toggle>
            <mat-datepicker #fromPicker></mat-datepicker>
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>To Date</mat-label>
            <input matInput [matDatepicker]="toPicker" [(ngModel)]="toDate" (dateChange)="onDateChange()">
            <mat-datepicker-toggle matSuffix [for]="toPicker"></mat-datepicker-toggle>
            <mat-datepicker #toPicker></mat-datepicker>
          </mat-form-field>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Key Metrics Dashboard -->
  <div class="metrics-section">
    <h2>Key Performance Indicators</h2>
    <div class="metrics-grid">
      <mat-card class="metric-card primary">
        <mat-card-header>
          <div class="metric-icon">
            <mat-icon>inventory</mat-icon>
          </div>
          <div class="metric-content">
            <mat-card-title>Total Inventory Value</mat-card-title>
            <mat-card-subtitle>Current stock valuation</mat-card-subtitle>
          </div>
        </mat-card-header>
        <mat-card-content>
          <div class="metric-value">{{ getTotalInventoryValue() | currency }}</div>
          <div class="metric-change" [class]="getChangeClass(inventoryValueChange)">
            <mat-icon>{{ getChangeIcon(inventoryValueChange) }}</mat-icon>
            {{ inventoryValueChange }}% vs last period
          </div>
        </mat-card-content>
      </mat-card>
      
      <mat-card class="metric-card success">
        <mat-card-header>
          <div class="metric-icon">
            <mat-icon>trending_up</mat-icon>
          </div>
          <div class="metric-content">
            <mat-card-title>Sales Revenue</mat-card-title>
            <mat-card-subtitle>Total sales in period</mat-card-subtitle>
          </div>
        </mat-card-header>
        <mat-card-content>
          <div class="metric-value">{{ getSalesRevenue() | currency }}</div>
          <div class="metric-change" [class]="getChangeClass(salesChange)">
            <mat-icon>{{ getChangeIcon(salesChange) }}</mat-icon>
            {{ salesChange }}% vs last period
          </div>
        </mat-card-content>
      </mat-card>
      
      <mat-card class="metric-card warn">
        <mat-card-header>
          <div class="metric-icon">
            <mat-icon>rotate_right</mat-icon>
          </div>
          <div class="metric-content">
            <mat-card-title>Inventory Turnover</mat-card-title>
            <mat-card-subtitle>Times per period</mat-card-subtitle>
          </div>
        </mat-card-header>
        <mat-card-content>
          <div class="metric-value">{{ getInventoryTurnover() }}x</div>
          <div class="metric-change" [class]="getChangeClass(turnoverChange)">
            <mat-icon>{{ getChangeIcon(turnoverChange) }}</mat-icon>
            {{ turnoverChange }}% vs last period
          </div>
        </mat-card-content>
      </mat-card>
      
      <mat-card class="metric-card accent">
        <mat-card-header>
          <div class="metric-icon">
            <mat-icon>warning</mat-icon>
          </div>
          <div class="metric-content">
            <mat-card-title>Low Stock Items</mat-card-title>
            <mat-card-subtitle>Items below threshold</mat-card-subtitle>
          </div>
        </mat-card-header>
        <mat-card-content>
          <div class="metric-value">{{ getLowStockCount() }}</div>
          <div class="metric-subtitle">{{ getLowStockPercentage() }}% of total items</div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>

  <!-- Report Categories -->
  <div class="report-categories">
    <h2>Available Reports</h2>
    <div class="categories-grid">
      
      <!-- Inventory Reports -->
      <mat-card class="category-card">
        <mat-card-header>
          <mat-icon class="category-icon inventory-icon">inventory_2</mat-icon>
          <mat-card-title>Inventory Reports</mat-card-title>
          <mat-card-subtitle>Stock levels and valuation</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="report-list">
            <button mat-stroked-button class="report-item" (click)="generateReport('inventory-valuation')">
              <div class="report-info">
                <span class="report-name">Inventory Valuation</span>
                <span class="report-desc">Current stock values by category</span>
              </div>
              <mat-icon>chevron_right</mat-icon>
            </button>
            
            <button mat-stroked-button class="report-item" (click)="generateReport('stock-levels')">
              <div class="report-info">
                <span class="report-name">Stock Levels</span>
                <span class="report-desc">Current quantities and locations</span>
              </div>
              <mat-icon>chevron_right</mat-icon>
            </button>
            
            <button mat-stroked-button class="report-item" (click)="generateReport('low-stock')">
              <div class="report-info">
                <span class="report-name">Low Stock Alert</span>
                <span class="report-desc">Items below minimum threshold</span>
              </div>
              <mat-icon>chevron_right</mat-icon>
            </button>
            
            <button mat-stroked-button class="report-item" (click)="generateReport('abc-analysis')">
              <div class="report-info">
                <span class="report-name">ABC Analysis</span>
                <span class="report-desc">Product categorization by value</span>
              </div>
              <mat-icon>chevron_right</mat-icon>
            </button>
          </div>
        </mat-card-content>
      </mat-card>
      
      <!-- Sales Reports -->
      <mat-card class="category-card">
        <mat-card-header>
          <mat-icon class="category-icon sales-icon">point_of_sale</mat-icon>
          <mat-card-title>Sales Reports</mat-card-title>
          <mat-card-subtitle>Sales performance and trends</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="report-list">
            <button mat-stroked-button class="report-item" (click)="generateReport('sales-summary')">
              <div class="report-info">
                <span class="report-name">Sales Summary</span>
                <span class="report-desc">Total sales and trends</span>
              </div>
              <mat-icon>chevron_right</mat-icon>
            </button>
            
            <button mat-stroked-button class="report-item" (click)="generateReport('top-products')">
              <div class="report-info">
                <span class="report-name">Top Selling Products</span>
                <span class="report-desc">Best performing items</span>
              </div>
              <mat-icon>chevron_right</mat-icon>
            </button>
            
            <button mat-stroked-button class="report-item" (click)="generateReport('sales-by-category')">
              <div class="report-info">
                <span class="report-name">Sales by Category</span>
                <span class="report-desc">Performance by product type</span>
              </div>
              <mat-icon>chevron_right</mat-icon>
            </button>
            
            <button mat-stroked-button class="report-item" (click)="generateReport('profit-analysis')">
              <div class="report-info">
                <span class="report-name">Profit Analysis</span>
                <span class="report-desc">Margin and profitability</span>
              </div>
              <mat-icon>chevron_right</mat-icon>
            </button>
          </div>
        </mat-card-content>
      </mat-card>
      
      <!-- Movement Reports -->
      <mat-card class="category-card">
        <mat-card-header>
          <mat-icon class="category-icon movement-icon">swap_horiz</mat-icon>
          <mat-card-title>Movement Reports</mat-card-title>
          <mat-card-subtitle>Stock movement analysis</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="report-list">
            <button mat-stroked-button class="report-item" (click)="generateReport('movement-summary')">
              <div class="report-info">
                <span class="report-name">Movement Summary</span>
                <span class="report-desc">All stock movements</span>
              </div>
              <mat-icon>chevron_right</mat-icon>
            </button>
            
            <button mat-stroked-button class="report-item" (click)="generateReport('transfer-report')">
              <div class="report-info">
                <span class="report-name">Transfer Report</span>
                <span class="report-desc">Inter-location movements</span>
              </div>
              <mat-icon>chevron_right</mat-icon>
            </button>
            
            <button mat-stroked-button class="report-item" (click)="generateReport('adjustments')">
              <div class="report-info">
                <span class="report-name">Stock Adjustments</span>
                <span class="report-desc">Inventory corrections</span>
              </div>
              <mat-icon>chevron_right</mat-icon>
            </button>
            
            <button mat-stroked-button class="report-item" (click)="generateReport('shrinkage')">
              <div class="report-info">
                <span class="report-name">Shrinkage Analysis</span>
                <span class="report-desc">Loss and damage tracking</span>
              </div>
              <mat-icon>chevron_right</mat-icon>
            </button>
          </div>
        </mat-card-content>
      </mat-card>
      
      <!-- Supplier Reports -->
      <mat-card class="category-card">
        <mat-card-header>
          <mat-icon class="category-icon supplier-icon">business</mat-icon>
          <mat-card-title>Supplier Reports</mat-card-title>
          <mat-card-subtitle>Vendor performance and analysis</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="report-list">
            <button mat-stroked-button class="report-item" (click)="generateReport('supplier-performance')">
              <div class="report-info">
                <span class="report-name">Supplier Performance</span>
                <span class="report-desc">Delivery and quality metrics</span>
              </div>
              <mat-icon>chevron_right</mat-icon>
            </button>
            
            <button mat-stroked-button class="report-item" (click)="generateReport('purchase-analysis')">
              <div class="report-info">
                <span class="report-name">Purchase Analysis</span>
                <span class="report-desc">Spending by supplier</span>
              </div>
              <mat-icon>chevron_right</mat-icon>
            </button>
            
            <button mat-stroked-button class="report-item" (click)="generateReport('cost-comparison')">
              <div class="report-info">
                <span class="report-name">Cost Comparison</span>
                <span class="report-desc">Price analysis across vendors</span>
              </div>
              <mat-icon>chevron_right</mat-icon>
            </button>
            
            <button mat-stroked-button class="report-item" (click)="generateReport('order-history')">
              <div class="report-info">
                <span class="report-name">Order History</span>
                <span class="report-desc">Purchase order tracking</span>
              </div>
              <mat-icon>chevron_right</mat-icon>
            </button>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>

  <!-- Recent Reports -->
  <div class="recent-reports">
    <div class="section-header">
      <h2>Recent Reports</h2>
      <button mat-stroked-button (click)="viewAllReports()">
        View All
        <mat-icon>arrow_forward</mat-icon>
      </button>
    </div>
    
    <div class="reports-table-container">
      <table mat-table [dataSource]="recentReports" class="reports-table">
        
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Report Name</th>
          <td mat-cell *matCellDef="let report">
            <div class="report-name-cell">
              <mat-icon class="report-type-icon">{{ getReportIcon(report.type) }}</mat-icon>
              <div class="report-details">
                <span class="report-title">{{ report.name }}</span>
                <span class="report-type">{{ report.type | titlecase }}</span>
              </div>
            </div>
          </td>
        </ng-container>
        
        <ng-container matColumnDef="period">
          <th mat-header-cell *matHeaderCellDef>Period</th>
          <td mat-cell *matCellDef="let report">{{ report.period }}</td>
        </ng-container>
        
        <ng-container matColumnDef="generated">
          <th mat-header-cell *matHeaderCellDef>Generated</th>
          <td mat-cell *matCellDef="let report">
            <div class="generated-cell">
              <span class="date">{{ report.generatedDate | date:'MMM d, y' }}</span>
              <span class="time">{{ report.generatedDate | date:'h:mm a' }}</span>
            </div>
          </td>
        </ng-container>
        
        <ng-container matColumnDef="size">
          <th mat-header-cell *matHeaderCellDef>Size</th>
          <td mat-cell *matCellDef="let report">{{ report.fileSize }}</td>
        </ng-container>
        
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Status</th>
          <td mat-cell *matCellDef="let report">
            <mat-chip class="status-chip" [class]="'status-' + report.status">
              <mat-icon>{{ getStatusIcon(report.status) }}</mat-icon>
              {{ report.status | titlecase }}
            </mat-chip>
          </td>
        </ng-container>
        
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let report">
            <div class="report-actions">
              <button mat-icon-button (click)="downloadReport(report)" matTooltip="Download">
                <mat-icon>file_download</mat-icon>
              </button>
              <button mat-icon-button (click)="viewReport(report)" matTooltip="View">
                <mat-icon>visibility</mat-icon>
              </button>
              <button mat-icon-button (click)="shareReport(report)" matTooltip="Share">
                <mat-icon>share</mat-icon>
              </button>
              <button mat-icon-button (click)="deleteReport(report)" matTooltip="Delete" class="delete-btn">
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </td>
        </ng-container>
        
        <tr mat-header-row *matHeaderRowDef="reportColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: reportColumns;"></tr>
      </table>
    </div>
  </div>

  <!-- Chart Preview Section -->
  <div class="chart-preview">
    <h2>Analytics Overview</h2>
    <div class="charts-grid">
      
      <!-- Sales Trend Chart -->
      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>Sales Trend</mat-card-title>
          <mat-card-subtitle>Revenue over time</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="chart-placeholder sales-chart">
            <mat-icon>trending_up</mat-icon>
            <p>Sales trend chart would be rendered here</p>
            <div class="chart-data">
              <div class="data-point">
                <span class="value">$45,230</span>
                <span class="label">This Month</span>
              </div>
              <div class="data-point">
                <span class="value">+12.5%</span>
                <span class="label">Growth</span>
              </div>
            </div>
          </div>
        </mat-card-content>
        <mat-card-actions>
          <button mat-button (click)="openDetailChart('sales')">
            <mat-icon>open_in_full</mat-icon>
            View Details
          </button>
        </mat-card-actions>
      </mat-card>
      
      <!-- Inventory Distribution -->
      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>Inventory Distribution</mat-card-title>
          <mat-card-subtitle>Stock by category</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="chart-placeholder inventory-chart">
            <mat-icon>donut_large</mat-icon>
            <p>Inventory distribution pie chart</p>
            <div class="chart-data">
              <div class="data-point">
                <span class="value">38%</span>
                <span class="label">Electronics</span>
              </div>
              <div class="data-point">
                <span class="value">25%</span>
                <span class="label">Accessories</span>
              </div>
            </div>
          </div>
        </mat-card-content>
        <mat-card-actions>
          <button mat-button (click)="openDetailChart('inventory')">
            <mat-icon>open_in_full</mat-icon>
            View Details
          </button>
        </mat-card-actions>
      </mat-card>
      
      <!-- Top Products -->
      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>Top Products</mat-card-title>
          <mat-card-subtitle>Best sellers this period</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="chart-placeholder products-chart">
            <mat-icon>bar_chart</mat-icon>
            <p>Top products bar chart</p>
            <div class="product-list">
              <div class="product-item">
                <span class="product-name">Wireless Headphones</span>
                <span class="product-sales">245 sold</span>
              </div>
              <div class="product-item">
                <span class="product-name">Bluetooth Speakers</span>
                <span class="product-sales">189 sold</span>
              </div>
            </div>
          </div>
        </mat-card-content>
        <mat-card-actions>
          <button mat-button (click)="openDetailChart('products')">
            <mat-icon>open_in_full</mat-icon>
            View Details
          </button>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>
</div>
